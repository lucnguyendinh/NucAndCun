<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>So khop day so</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg-1: #0d1b2a;
      --bg-2: #1b263b;
      --accent: #3dd6d0;
      --accent-2: #f4a261;
      --card: rgba(255, 255, 255, 0.06);
      --text: #e9ecef;
      --muted: #9aa5b1;
      --radius: 18px;
    }
    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: 'Space Grotesk', system-ui, -apple-system, sans-serif;
      color: var(--text);
      background: radial-gradient(circle at 20% 20%, #1e3d59 0%, #0d1b2a 45%),
                  radial-gradient(circle at 80% 0%, #1f456e 0%, #0d1b2a 40%),
                  linear-gradient(135deg, var(--bg-2), #0b1320 60%);
      min-height: 100vh;
      display: grid;
      place-items: center;
      padding: 32px;
    }
    .shell {
      width: min(960px, 100%);
      background: var(--card);
      border: 1px solid rgba(255, 255, 255, 0.08);
      border-radius: var(--radius);
      padding: 32px;
      box-shadow: 0 20px 80px rgba(0, 0, 0, 0.45);
      backdrop-filter: blur(10px);
      position: relative;
      overflow: hidden;
    }
    .shell::after {
      content: '';
      position: absolute;
      inset: 0;
      background: radial-gradient(circle at 30% 20%, rgba(61, 214, 208, 0.12), transparent 45%),
                  radial-gradient(circle at 80% 60%, rgba(244, 162, 97, 0.12), transparent 50%);
      pointer-events: none;
    }
    h1 {
      margin: 0 0 8px;
      font-size: 32px;
      letter-spacing: -0.5px;
    }
    p.lead {
      margin: 0 0 24px;
      color: var(--muted);
      line-height: 1.5;
    }
    .grid {
      display: grid;
      gap: 20px;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      margin-bottom: 20px;
    }
    label {
      display: block;
      margin-bottom: 8px;
      color: var(--muted);
      font-size: 14px;
      letter-spacing: 0.2px;
    }
    textarea, input {
      width: 100%;
      border-radius: 12px;
      border: 1px solid rgba(255, 255, 255, 0.12);
      background: rgba(255, 255, 255, 0.04);
      color: var(--text);
      padding: 12px 14px;
      font-size: 15px;
      transition: border 0.2s ease, box-shadow 0.2s ease, transform 0.2s ease;
      outline: none;
    }
    textarea:focus, input:focus {
      border-color: var(--accent);
      box-shadow: 0 0 0 4px rgba(61, 214, 208, 0.15);
      transform: translateY(-1px);
    }
    textarea {
      min-height: 110px;
      resize: vertical;
    }
    .bar {
      display: flex;
      align-items: center;
      gap: 12px;
      margin: 12px 0 4px;
      flex-wrap: wrap;
    }
    button {
      border: none;
      background: linear-gradient(120deg, var(--accent), #79f2f2);
      color: #0b1320;
      font-weight: 700;
      padding: 12px 18px;
      border-radius: 12px;
      cursor: pointer;
      transition: transform 0.15s ease, box-shadow 0.2s ease;
      box-shadow: 0 12px 30px rgba(61, 214, 208, 0.25);
    }
    button:hover {
      transform: translateY(-1px) scale(1.01);
      box-shadow: 0 16px 40px rgba(61, 214, 208, 0.28);
    }
    button:active {
      transform: translateY(0);
    }
    .pill {
      padding: 8px 12px;
      border-radius: 999px;
      background: rgba(255, 255, 255, 0.06);
      border: 1px solid rgba(255, 255, 255, 0.1);
      color: var(--muted);
      font-size: 13px;
    }
    .results {
      display: grid;
      gap: 12px;
      margin-top: 16px;
    }
    .metric {
      display: flex;
      justify-content: space-between;
      align-items: center;
      background: rgba(255, 255, 255, 0.04);
      border: 1px solid rgba(255, 255, 255, 0.06);
      border-radius: 12px;
      padding: 12px 14px;
    }
    .metric strong { color: var(--accent); }
    .list {
      display: flex;
      gap: 6px;
      flex-wrap: wrap;
      margin: 8px 0 0;
    }
    .chip {
      padding: 8px 10px;
      border-radius: 10px;
      background: rgba(61, 214, 208, 0.12);
      border: 1px solid rgba(61, 214, 208, 0.4);
      color: #b8f2f2;
      font-weight: 600;
      letter-spacing: 0.2px;
    }
    .chip.alt {
      background: rgba(244, 162, 97, 0.12);
      border-color: rgba(244, 162, 97, 0.45);
      color: #ffd7b0;
    }
    .note { color: var(--muted); font-size: 14px; line-height: 1.5; }
    .fade { animation: fadeIn 0.6s ease; }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(6px); }
      to { opacity: 1; transform: translateY(0); }
    }
  </style>
</head>
<body>
  <main class="shell">
    <h1>Kiem tra so trung</h1>
    <p class="lead">Nhap day so bi mat va day so du doan. Cong cu se dem so luong so trung nhau (tinh ca truong hop trung lap) giua hai day.</p>

    <div class="grid">
      <div>
        <label for="secret">Day so bi mat (nguoi ra de)</label>
        <textarea id="secret" placeholder="Vi du: 3, 3, 7, 9, 12"></textarea>
      </div>
      <div>
        <label for="guess">Day so du doan (nguoi doan)</label>
        <textarea id="guess" placeholder="Vi du: 1 3 5 7 7 12"></textarea>
      </div>
    </div>

    <div class="bar">
      <button id="check">Tinh so trung</button>
      <span class="pill">Co the nhap lien tiep (12345) hoac ngan cach bang dau phay, dau cham phay, dau cach, xuong dong.</span>
    </div>

    <section class="results" id="results" aria-live="polite"></section>
    <p class="note">Cach tinh: moi con so se duoc doi sang dang so (Number). Moi lan so do xuat hien trong day doan, no chi duoc tinh la trung neu day bi mat con du so do (theo tan suat xuat hien). Vi du: bi mat "3, 3, 7", doan "3, 7, 7" -> so trung la 2 (mot so 3 va mot so 7).</p>
  </main>

  <script>
    const secretEl = document.getElementById('secret');
    const guessEl = document.getElementById('guess');
    const resultsEl = document.getElementById('results');

    function parseSequence(raw) {
      const trimmed = raw.trim();
      if (!trimmed) return [];

      const hasDelimiter = /[\n,;\s]/.test(trimmed);

      if (!hasDelimiter) {
        return trimmed
          .split('')
          .map(Number)
          .filter(n => Number.isFinite(n));
      }

      return trimmed
        .split(/[\n,;\s]+/)
        .map(part => part.trim())
        .filter(Boolean)
        .map(Number)
        .filter(n => Number.isFinite(n));
    }

    function countMatches(secretArr, guessArr) {
      const freq = new Map();
      secretArr.forEach(n => freq.set(n, (freq.get(n) || 0) + 1));

      const matched = [];
      const unmatchedGuess = [];

      guessArr.forEach(n => {
        const count = freq.get(n) || 0;
        if (count > 0) {
          matched.push(n);
          freq.set(n, count - 1);
        } else {
          unmatchedGuess.push(n);
        }
      });

      return { matched, unmatchedGuess, remainingSecret: freq };
    }

    function renderResults() {
      const secretSeq = parseSequence(secretEl.value);
      const guessSeq = parseSequence(guessEl.value);

      if (!secretSeq.length || !guessSeq.length) {
        resultsEl.innerHTML = '<div class="metric fade"><span>Can nhap ca hai day so.</span></div>';
        return;
      }

      const { matched, unmatchedGuess, remainingSecret } = countMatches(secretSeq, guessSeq);
      const remainingSecretList = [];
      remainingSecret.forEach((count, value) => {
        for (let i = 0; i < count; i++) remainingSecretList.push(value);
      });

      const perfect = matched.length === secretSeq.length && unmatchedGuess.length === 0;
      const overlapText = perfect ? 'Doan chinh xac hoan toan!' : `${matched.length} so trung.`;

      resultsEl.innerHTML = `
        <div class="metric fade">
          <span>Do dai day bi mat</span>
          <strong>${secretSeq.length}</strong>
        </div>
        <div class="metric fade">
          <span>Do dai day du doan</span>
          <strong>${guessSeq.length}</strong>
        </div>
        <div class="metric fade">
          <span>Ket qua</span>
          <strong>${overlapText}</strong>
        </div>
        <div class="metric fade">
          <span>Cac so trung (tinh tan suat)</span>
          <div class="list">${matched.length ? matched.map(n => `<span class="chip">${n}</span>`).join('') : '<span class="pill">Khong co</span>'}</div>
        </div>
        <div class="metric fade">
          <span>So doan chua khop</span>
          <div class="list">${unmatchedGuess.length ? unmatchedGuess.map(n => `<span class="chip alt">${n}</span>`).join('') : '<span class="pill">Khong co</span>'}</div>
        </div>
        <div class="metric fade">
          <span>So bi mat chua bi doan</span>
          <div class="list">${remainingSecretList.length ? remainingSecretList.map(n => `<span class="chip alt">${n}</span>`).join('') : '<span class="pill">Khong con</span>'}</div>
        </div>
      `;
    }

    document.getElementById('check').addEventListener('click', renderResults);

    [secretEl, guessEl].forEach(el => {
      el.addEventListener('input', () => {
        resultsEl.innerHTML = '';
      });
    });
  </script>
</body>
</html>
